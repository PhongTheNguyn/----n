generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                                            String          @id @default(cuid())
  email                                         String          @unique @db.VarChar(255)
  passwordHash                                  String          @map("password_hash")
  displayName                                   String          @map("display_name") @db.VarChar(100)
  gender                                        String          @db.VarChar(20)
  country                                       String          @db.VarChar(100)
  age                                           Int
  bio                                           String?
  avatarUrl                                     String?         @map("avatar_url")
  createdAt                                     DateTime        @default(now()) @map("created_at") @db.Timestamptz(6)
  blocked_users_blocked_users_blocked_idTousers blocked_users[] @relation("blocked_users_blocked_idTousers")
  blocked_users_blocked_users_blocker_idTousers blocked_users[] @relation("blocked_users_blocker_idTousers")
  user_reports_user_reports_reported_idTousers  user_reports[]  @relation("user_reports_reported_idTousers")
  user_reports_user_reports_reporter_idTousers  user_reports[]  @relation("user_reports_reporter_idTousers")

  @@map("users")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model blocked_users {
  id                                    String   @id
  blocker_id                            String
  blocked_id                            String
  created_at                            DateTime @default(now()) @db.Timestamptz(6)
  users_blocked_users_blocked_idTousers User     @relation("blocked_users_blocked_idTousers", fields: [blocked_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users_blocked_users_blocker_idTousers User     @relation("blocked_users_blocker_idTousers", fields: [blocker_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([blocker_id, blocked_id], map: "unique_block")
  @@index([blocked_id], map: "idx_blocked_users_blocked")
  @@index([blocker_id], map: "idx_blocked_users_blocker")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model user_reports {
  id                                    String   @id
  reporter_id                           String
  reported_id                           String
  reason                                String   @db.VarChar(50)
  description                           String?
  status                                String   @default("pending") @db.VarChar(20)
  created_at                            DateTime @default(now()) @db.Timestamptz(6)
  users_user_reports_reported_idTousers User     @relation("user_reports_reported_idTousers", fields: [reported_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users_user_reports_reporter_idTousers User     @relation("user_reports_reporter_idTousers", fields: [reporter_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([reported_id], map: "idx_user_reports_reported")
  @@index([reporter_id], map: "idx_user_reports_reporter")
  @@index([status], map: "idx_user_reports_status")
}
